<!-- Sách mới nhất Section -->
<div class="container-fluid px-3 px-md-4 mt-4">
  <h2 class="mb-3 fs-3 fs-md-2">Sách mới nhất</h2>
  <div class="position-relative">
    <div
      id="newBooksContainer"
      class="d-flex overflow-auto gap-3 pb-3"
      style="scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;"
    >
      {{#each newBooks}}
        <div
          class="card flex-shrink-0 product-card shadow-sm"
          style="width: clamp(250px, 18rem, 90vw); scroll-snap-align: start;"
          data-id="{{this.book_id}}"
          data-title="{{this.book_title}}"
          data-price="{{this.price}}"
          data-discount="{{this.discount_percentage}}"
          data-description="{{this.description}}"
          data-image="{{this.image_path}}"
          data-author="{{this.author_name}}"
          data-publisher="{{this.publisher_name}}"
          data-category="{{this.category_name}}"
        >
          <!-- Image Container with Fixed Aspect Ratio -->
          <div
            class="position-relative bg-light"
            style="padding-top: 140%; overflow: hidden;"
          >
            <img
              src="{{this.image_path}}"
              class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
              alt="{{this.book_title}}"
              onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22280%22%3E%3Crect width=%22200%22 height=%22280%22 fill=%22%23e9ecef%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial, sans-serif%22 font-size=%2216%22 fill=%22%236c757d%22%3EKhông có ảnh%3C/text%3E%3C/svg%3E';"
            />
          </div>

          <div class="card-body d-flex flex-column p-3">
            <h5
              class="card-title fs-6 fw-semibold mb-2"
              style="
              display: -webkit-box;
              -webkit-line-clamp: 2;
              -webkit-box-orient: vertical;
              overflow: hidden;
              min-height: 2.5rem;
            "
            >
              {{this.book_title}}
            </h5>

            <p class="card-text fw-bold mt-auto mb-3">
              <span class="text-danger d-block">
                Giá bán:
                {{formatPrice this.selling_price}}
                ₫
                {{#if this.discount_percentage}}
                  <span
                    class="badge bg-danger ms-1"
                  >-{{this.discount_percentage}}%</span>
                {{/if}}
              </span>
              <small class="text-muted text-decoration-line-through d-block">
                {{formatPrice this.original_price}}
                ₫
              </small>
            </p>

            <div class="d-flex flex-column gap-2">
              <div class="d-flex gap-2">
                <a
                  href="/products/{{this.book_id}}"
                  class="btn btn-outline-secondary btn-sm flex-grow-1"
                >
                  <i class="bi bi-eye"></i>
                  Xem
                </a>
                <button
                  type="button"
                  class="btn btn-outline-primary btn-sm flex-grow-1 product__btn--add-to-cart"
                  data-id="{{this.book_id}}"
                >
                  <i class="bi bi-cart-plus"></i>
                  Giỏ
                </button>
              </div>
              <a href="/checkout/buy/{{this.book_id}}" class="w-100">
                <button
                  type="button"
                  class="btn btn-primary btn-sm w-100 btn-buy"
                >
                  <i class="bi bi-bag"></i>
                  Mua ngay
                </button>
              </a>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</div>

<!-- Giảm giá sốc Section -->
<div class="container-fluid px-3 px-md-4 mt-5">
  <h2 class="mb-3 fs-3 fs-md-2">
    Giảm giá sốc
    <i class="bi bi-lightning-charge-fill text-danger"></i>
  </h2>
  <div class="position-relative">
    <div
      id="discountedBooksContainer"
      class="d-flex overflow-auto gap-3 pb-3"
      style="scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;"
    >
      {{#each discountedBooks}}
        <div
          class="card flex-shrink-0 product-card shadow-sm"
          style="width: clamp(250px, 18rem, 90vw); scroll-snap-align: start;"
          data-id="{{this.book_id}}"
          data-title="{{this.book_title}}"
          data-price="{{this.price}}"
          data-discount="{{this.discount_percentage}}"
          data-description="{{this.description}}"
          data-image="{{this.image_path}}"
          data-author="{{this.author_name}}"
          data-publisher="{{this.publisher_name}}"
          data-category="{{this.category_name}}"
        >
          <!-- Image Container with Fixed Aspect Ratio -->
          <div
            class="position-relative bg-light"
            style="padding-top: 140%; overflow: hidden;"
          >
            <img
              src="{{this.image_path}}"
              class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
              alt="{{this.book_title}}"
              onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22280%22%3E%3Crect width=%22200%22 height=%22280%22 fill=%22%23e9ecef%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial, sans-serif%22 font-size=%2216%22 fill=%22%236c757d%22%3EKhông có ảnh%3C/text%3E%3C/svg%3E';"
            />
            {{#if this.has_discount}}
              <div class="position-absolute top-0 end-0 m-2">
                <span class="badge bg-danger fs-6 shadow">
                  -{{this.discount_percentage}}%
                </span>
              </div>
            {{/if}}
          </div>

          <div class="card-body d-flex flex-column p-3">
            <h5
              class="card-title fs-6 fw-semibold mb-2"
              style="
              display: -webkit-box;
              -webkit-line-clamp: 2;
              -webkit-box-orient: vertical;
              overflow: hidden;
              min-height: 2.5rem;
            "
            >
              {{this.book_title}}
            </h5>

            <p class="card-text fw-bold mt-auto mb-3">
              {{#if this.has_discount}}
                <span class="text-danger d-block">
                  Giá bán:
                  {{formatPrice this.selling_price}}
                  ₫
                </span>
                <small class="text-muted text-decoration-line-through d-block">
                  {{formatPrice this.original_price}}
                  ₫
                </small>
              {{else}}
                <span class="d-block">
                  Giá bán:
                  {{formatPrice this.original_price}}
                  ₫
                </span>
              {{/if}}
            </p>

            <div class="d-flex flex-column gap-2">
              <div class="d-flex gap-2">
                <a
                  href="/products/{{this.book_id}}"
                  class="btn btn-outline-secondary btn-sm flex-grow-1"
                >
                  <i class="bi bi-eye"></i>
                  Xem
                </a>
                <button
                  type="button"
                  class="btn btn-outline-primary btn-sm flex-grow-1 product__btn--add-to-cart"
                  data-id="{{this.book_id}}"
                >
                  <i class="bi bi-cart-plus"></i>
                  Giỏ
                </button>
              </div>
              <a href="/checkout/buy/{{this.book_id}}" class="w-100">
                <button
                  type="button"
                  class="btn btn-primary btn-sm w-100 btn-buy"
                >
                  <i class="bi bi-bag"></i>
                  Mua ngay
                </button>
              </a>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</div>

<script src="/js/client/home.js"></script>