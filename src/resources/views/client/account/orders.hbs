<div class="container py-4">
  <h3 class="mb-4">Đơn hàng của tôi</h3>

  <div class="row mb-3 align-items-center">
    <div class="col-12 col-md-4">
      <form id="order-filter-form" method="GET" action="/account/orders" class="d-flex gap-2">
        <select name="order_status" id="order-status-filter" class="form-select">
          <option value="">-- Tất cả trạng thái --</option>
          <option value="1" {{#if (eq order_status '1')}}selected{{/if}}>Chờ xác nhận</option>
          <option value="2" {{#if (eq order_status '2')}}selected{{/if}}>Đang chuẩn bị</option>
          <option value="3" {{#if (eq order_status '3')}}selected{{/if}}>Đang giao</option>
          <option value="4" {{#if (eq order_status '4')}}selected{{/if}}>Đã giao</option>
          <option value="5" {{#if (eq order_status '5')}}selected{{/if}}>Đã hủy</option>
        </select>

        <button type="submit" class="btn btn-secondary d-none">Lọc</button>
      </form>
    </div>
  </div>
  {{#if orders.length}}
    <div class="list-group">
      {{#each orders}}
        <div class="list-group-item d-flex justify-content-between align-items-start flex-column flex-sm-row">
          <div class="mb-2 mb-sm-0">
            <div><strong>Mã đơn:</strong> #{{this.order_id}}</div>
            <div><strong>Ngày:</strong> {{formatDate this.created_at}}</div>
            <div><strong>Tổng:</strong> {{formatPrice this.total_amount}} ₫</div>
          </div>

          <div class="d-flex gap-2 align-items-center">
            <span>{{ this.status_name}}</span>

            <a class="btn btn-sm btn-primary" href="/account/orders/{{this.order_id}}">
              Xem chi tiết
            </a>

            {{#if (eq this.status_id 1)}}
              <button class="btn btn-sm btn-danger"
                      data-bs-toggle="modal"
                      data-bs-target="#cancel-order-modal"
                      data-id="{{this.order_id}}"
                      data-name="Đơn hàng #{{this.order_id}}">
                Hủy
              </button>
            {{/if}}
          </div>
        </div>
      {{/each}}
    </div>
  {{else}}
    <p>Không có đơn hàng nào.</p>
  {{/if}}
</div>
<script src="/js/admin/common-modal.js"></script>
<script src="/js/client/order.js"></script>